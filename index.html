<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#007bff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Â£ΩÂè∏Ë®àÊï∏">
    <meta name="description" content="ÈÇäÈ£üÈáéÈÇäË®àÊï∏ÔºåÂç≥ÊôÇÁü•ÈÅì‰Ω†È£üÂ∑¶ÂπæÈå¢! üç£">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'><rect fill='%23007bff' width='192' height='192'/><text x='96' y='120' font-size='100' text-anchor='middle' fill='white' font-family='Arial'>üç£</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect fill='%23007bff' width='180' height='180' rx='40'/><text x='90' y='135' font-size='90' text-anchor='middle' fill='white' font-family='Arial'>üç£</text></svg>">
    <title>Â£ΩÂè∏ÈÉéË®àÊï∏Ê©ü</title>
    <style>
        :root {
            --color-red: #d32f2f;
            --color-silver: #9e9e9e;
            --color-gold: #ffb300;
            --color-black: #212121;
            --color-primary: #007bff;
            --color-bg: #f5f5f5;
            --color-text: #333;
            --color-text-secondary: #666;
        }

        * {
            box-sizing: border-box;
        }

        html, body {
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--color-bg);
            padding: 0;
            padding-bottom: max(180px, calc(180px + env(safe-area-inset-bottom)));
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        /* Sticky Header - Cover Dynamic Island */
        .header {
            position: sticky;
            top: 0;
            background: white;
            padding: 16px 20px;
            padding-top: max(12px, env(safe-area-inset-top));
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            z-index: 90;
        }

        h1 {
            text-align: center;
            color: var(--color-text);
            font-size: 1.3rem;
            margin: 0;
            font-weight: 600;
        }

        /* Âç°ÁâáÊ®£Âºè */
        .card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin: 0 20px 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* È°èËâ≤Ë≠òÂà•Ê¢ù */
        .color-indicator {
            width: 10px;
            height: 50px;
            border-radius: 5px;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .red { background-color: var(--color-red); }
        .silver { background-color: var(--color-silver); }
        .gold { background-color: var(--color-gold); }
        .black { background-color: var(--color-black); }

        .info {
            flex-grow: 1;
        }

        .price-label {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--color-text);
        }

        /* ÊåâÈàïÊéßÂà∂ÂçÄ */
        .controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ctrl-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            transition: all 0.15s ease;
            -webkit-user-select: none;
            user-select: none;
        }

        .btn-minus {
            background-color: #e0e0e0;
            color: #757575;
        }

        .btn-minus:active {
            background-color: #d0d0d0;
            transform: scale(0.95);
        }

        .btn-plus {
            background-color: var(--color-primary);
            color: white;
        }

        .btn-plus:active {
            background-color: #0056b3;
            transform: scale(0.95);
        }

        .count-display {
            font-size: 1.3rem;
            font-weight: bold;
            width: 36px;
            text-align: center;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.2s ease;
        }

        .count-display:active {
            background-color: #e8e8e8;
        }

        .count-input-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.2s ease;
        }

        .count-input-dialog {
            background: white;
            border-radius: 20px;
            padding: 30px 20px;
            width: 90%;
            max-width: 300px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .count-input-dialog h3 {
            margin: 0 0 20px 0;
            font-size: 1.1rem;
            text-align: center;
            color: var(--color-text);
        }

        .count-input-dialog input {
            width: 100%;
            padding: 12px;
            font-size: 1.2rem;
            border: 2px solid var(--color-primary);
            border-radius: 10px;
            text-align: center;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        .count-input-dialog input:focus {
            outline: none;
            border-color: #0056b3;
            box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.2);
        }

        .count-input-buttons {
            display: flex;
            gap: 10px;
        }

        .count-input-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-cancel {
            background-color: #e0e0e0;
            color: #666;
        }

        .btn-cancel:active {
            background-color: #d0d0d0;
        }

        .btn-confirm {
            background-color: var(--color-primary);
            color: white;
        }

        .btn-confirm:active {
            background-color: #0056b3;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* ÁâπÂà•ÊñôÁêÜÂçÄÂüü */
        .section-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--color-text);
            margin: 25px 20px 15px 20px;
            padding: 10px 0;
            border-bottom: 2px solid var(--color-primary);
        }

        /* Ëº∏ÂÖ•ÂÖ∂‰ªñÈáëÈ°ç */
        .custom-input {
            width: calc(100% - 40px);
            margin: 0 20px;
            padding: 12px;
            font-size: 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-top: 10px;
        }

        .add-item-btn {
            width: calc(100% - 40px);
            margin: 15px 20px;
            padding: 14px 20px;
            font-size: 1rem;
            background: transparent;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            letter-spacing: 0.5px;
        }

        .add-item-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(0, 123, 255, 0.08);
            transition: left 0.4s ease;
            z-index: -1;
        }

        .add-item-btn:hover {
            background: rgba(0, 123, 255, 0.08);
            border-color: #0056b3;
            color: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }

        .add-item-btn:active {
            background: rgba(0, 123, 255, 0.12);
            border-color: #003d82;
            color: #003d82;
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(0, 123, 255, 0.1);
        }

        .add-item-btn::before:hover {
            left: 100%;
        }

        .custom-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            margin: 8px 0;
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }

        .custom-item-info {
            flex-grow: 1;
        }

        .custom-item-name {
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 4px;
        }

        .custom-item-amount {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--color-text);
        }

        .custom-item-delete {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background-color: #e0e0e0;
            color: #757575;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.15s ease;
            flex-shrink: 0;
            margin-left: 10px;
        }

        .custom-item-delete:active {
            background-color: #d0d0d0;
        }

        /* ÈáçÁΩÆÊåâÈàï */
        .reset-container {
            text-align: center;
            margin: 25px 20px 20px 20px;
        }

        .reset-btn {
            background-color: white;
            border: 1px solid var(--color-red);
            color: var(--color-red);
            padding: 10px 30px;
            font-size: 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .reset-btn:active {
            background-color: var(--color-red);
            color: white;
        }

        /* Â∫ïÈÉ®Âõ∫ÂÆöÁµêÁÆóÊ¨Ñ - Safe Area ÈÅ©ÈÖç */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 -4px 15px rgba(0,0,0,0.15);
            padding: 15px 20px;
            padding-bottom: max(15px, env(safe-area-inset-bottom));
            border-radius: 16px 16px 0 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .total-label {
            font-size: 0.9rem;
            color: var(--color-text-secondary);
            margin-bottom: 4px;
        }

        .final-price-container {
            text-align: right;
        }

        .final-price {
            font-size: 2rem;
            font-weight: bold;
            color: var(--color-red);
            line-height: 1;
        }

        .service-charge {
            font-size: 0.8rem;
            color: #888;
            margin-top: 5px;
            text-align: center;
        }

        /* Modal Ê®£Âºè */
        dialog {
            border: none;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            max-width: 95vw;
            max-height: 80vh;
            padding: 0;
            animation: slideUp 0.3s ease-out;
        }

        dialog::backdrop {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(3px);
        }

        @keyframes slideUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            background: white;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.3rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-body {
            max-height: calc(80vh - 100px);
            overflow-y: auto;
            padding: 10px;
            padding-bottom: 20px;
        }

        .modal-category {
            font-weight: bold;
            font-size: 1rem;
            color: var(--color-text);
            background: #f5f5f5;
            padding: 12px 12px 8px 12px;
            margin-top: 12px;
            border-bottom: 2px solid var(--color-primary);
        }

        .modal-category:first-child {
            margin-top: 0;
        }

        .modal-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        .modal-item-info {
            flex-grow: 1;
        }

        .modal-item-name {
            font-weight: 500;
            font-size: 1rem;
            color: var(--color-text);
        }

        .modal-item-price {
            font-size: 0.9rem;
            color: var(--color-primary);
            font-weight: bold;
        }

        .modal-item-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .modal-item-count {
            width: 30px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .small-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            transition: all 0.15s ease;
        }

        .small-btn-minus {
            background-color: #f0f0f0;
            color: #888;
        }

        .small-btn-minus:active {
            background-color: #e0e0e0;
        }

        .small-btn-plus {
            background-color: var(--color-primary);
            color: white;
        }

        .small-btn-plus:active {
            background-color: #0056b3;
        }

        /* Scrollbar Ê®£Âºè */
        .modal-body::-webkit-scrollbar {
            width: 6px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: transparent;
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: #ddd;
            border-radius: 3px;
        }

        .modal-body::-webkit-scrollbar-thumb:hover {
            background: #999;
        }
    </style>
</head>
<body>

    <!-- Sticky Header -->
    <div class="header">
        <h1>üç£ È¶ôÊ∏ØÂ£ΩÂè∏ÈÉéË®àÊï∏Ê©ü</h1>
    </div>

    <!-- È°èËâ≤Á¢üÂçÄÂüü -->
    <div class="section-title">üçΩÔ∏è È°èËâ≤Á¢ü (ÊåâÊï∏Â≠óÂèØ‰∫∫ÊâãËº∏ÂÖ•Êï∏Èáè)</div>

    <div class="card">
        <div class="color-indicator red"></div>
        <div class="info">
            <div class="price-label">Á¥ÖÁ¢ü $12</div>
        </div>
        <div class="controls">
            <button class="ctrl-btn btn-minus" onclick="updateCount('red', -1)">‚àí</button>
            <span id="red-count" class="count-display" onclick="openCountInputModal('red')">0</span>
            <button class="ctrl-btn btn-plus" onclick="updateCount('red', 1)">+</button>
        </div>
    </div>

    <div class="card">
        <div class="color-indicator silver"></div>
        <div class="info">
            <div class="price-label">ÈäÄÁ¢ü $17</div>
        </div>
        <div class="controls">
            <button class="ctrl-btn btn-minus" onclick="updateCount('silver', -1)">‚àí</button>
            <span id="silver-count" class="count-display" onclick="openCountInputModal('silver')">0</span>
            <button class="ctrl-btn btn-plus" onclick="updateCount('silver', 1)">+</button>
        </div>
    </div>

    <div class="card">
        <div class="color-indicator gold"></div>
        <div class="info">
            <div class="price-label">ÈáëÁ¢ü $22</div>
        </div>
        <div class="controls">
            <button class="ctrl-btn btn-minus" onclick="updateCount('gold', -1)">‚àí</button>
            <span id="gold-count" class="count-display" onclick="openCountInputModal('gold')">0</span>
            <button class="ctrl-btn btn-plus" onclick="updateCount('gold', 1)">+</button>
        </div>
    </div>

    <div class="card">
        <div class="color-indicator black"></div>
        <div class="info">
            <div class="price-label">ÈªëÁ¢ü $27</div>
        </div>
        <div class="controls">
            <button class="ctrl-btn btn-minus" onclick="updateCount('black', -1)">‚àí</button>
            <span id="black-count" class="count-display" onclick="openCountInputModal('black')">0</span>
            <button class="ctrl-btn btn-plus" onclick="updateCount('black', 1)">+</button>
        </div>
    </div>

    <!-- ÁâπÂà•ÊñôÁêÜÂçÄÂüü -->
    <div class="section-title">‚ú® ÁâπÂà•ÊñôÁêÜ</div>

    <div class="card">
        <div class="info">
            <div class="price-label">MENU</div>
            <div style="font-size: 0.9rem; color: #999; margin-top: 4px;">ÈªûÊìäÊü•ÁúãÂÖ®ÈÉ®ÁâπÂà•ÊñôÁêÜ</div>
        </div>
        <button class="ctrl-btn btn-plus" onclick="openSpecialDishesModal()" style="margin-left: auto;">+</button>
    </div>

    <!-- ÁâπÂà•ÊñôÁêÜÁ∏ΩÈ°ç -->
    <div class="card" style="background: #f9f9f9; border: 1px solid #e0e0e0;">
        <div class="info">
            <div class="price-label">ÁâπÂà•ÊñôÁêÜÁ∏ΩÊï∏</div>
            <div style="font-size: 0.9rem; color: #999; margin-top: 4px;">$<span id="special-total">0</span></div>
        </div>
        <div style="font-size: 1.3rem; font-weight: bold; color: var(--color-primary);">
            <span id="special-count">0</span> ‰ª∂
        </div>
    </div>

    <!-- ÂÖ∂‰ªñÈáëÈ°çËº∏ÂÖ• -->
    <div class="section-title">ü•§ ÂÖ∂‰ªñÈ†ÖÁõÆ(‰ª•‰∏äMENUÁÑ°ÊôÇ‰∫∫ÊâãËº∏ÂÖ•)</div>

    <div style="margin: 0 20px;">
        <div class="price-label">ÂÖ∂‰ªñÈ†ÖÁõÆÔºö</div>
        <div id="custom-items-list" style="margin-top: 10px; margin-bottom: 15px;">
            <!-- ÂãïÊÖãÁîüÊàêÈ†ÖÁõÆ -->
        </div>
        <button class="add-item-btn" onclick="openCustomItemModal()">+ Êñ∞Â¢ûÈ†ÖÁõÆ</button>
    </div>

    <!-- ÈáçÁΩÆÊåâÈàï -->
    <div class="reset-container">
        <button class="reset-btn" onclick="resetAll()">ÂÖ®ÈÉ®ÈáçÁΩÆ</button>
    </div>

    <!-- Â∫ïÈÉ®ÁµêÁÆóÊ¨Ñ -->
    <div class="footer">
        <div class="total-row">
            <div>
                <div class="total-label">Á∏ΩÈ£üÁâ©Êï∏ÁõÆ: <span id="total-plates" style="font-weight:bold; color:var(--color-text);">0</span></div>
                <div class="total-label">Ê∑®È£üÁâ©Á∏ΩÊï∏: $<span id="subtotal">0</span></div>
            </div>
            <div class="final-price-container">
                <div class="total-label" style="margin-bottom:0;">È†êË®àÂüãÂñÆÂÉπÈå¢</div>
                <div class="final-price">$<span id="grand-total">0</span></div>
            </div>
        </div>
        <div class="service-charge">(Â∑≤ÂåÖÊã¨ 10% ÊúçÂãôË≤ªÔºåÈáëÈ°çÂÉÖ‰æõÂèÉËÄÉ)</div>
    </div>

    <!-- ÁâπÂà•ÊñôÁêÜ Modal -->
    <dialog id="specialDishesModal">
        <div class="modal-header">
            <h2>ÁâπÂà•ÊñôÁêÜËèúÂñÆ</h2>
            <button class="modal-close" onclick="document.getElementById('specialDishesModal').close()">‚úï</button>
        </div>
        <div class="modal-body" id="modalBody">
            <!-- ÂãïÊÖãÁîüÊàê -->
        </div>
    </dialog>

    <script>
        // Êï∏ÊìöÁµêÊßã
        const specialDishes = [
            // ÊñôÁêÜ
            { id: 'dish1', name: 'ÈùíÂîêËæõÂ≠êÁáíÊ§íÈÜ¨', price: 3, category: 'ÊñôÁêÜ' },
            { id: 'dish2', name: 'ÈªÉÈáëËÑÜËñØ', price: 13, category: 'ÊñôÁêÜ' },
            { id: 'dish3', name: 'ÂçóÁìúÂ§©Â©¶ÁæÖ', price: 13, category: 'ÊñôÁêÜ' },
            { id: 'dish4', name: 'ÁÇ∏Ëù¶Â§©Â©¶ÁæÖÊãºÁõ§(Âçä‰ªΩ)', price: 18, category: 'ÊñôÁêÜ' },
            { id: 'dish5', name: 'ÁÇ∏Ëù¶Â§©Â©¶ÁæÖ', price: 18, category: 'ÊñôÁêÜ' },
            { id: 'dish6', name: 'ÁÇ∏ÈõûËªüÈ™®', price: 19, category: 'ÊñôÁêÜ' },
            { id: 'dish7', name: 'Ëå∂Á¢óËí∏', price: 19, category: 'ÊñôÁêÜ' },
            { id: 'dish8', name: 'ËúÜËÇâÊµ∑ËãîÈ∫µË±âÊπØ', price: 20, category: 'ÊñôÁêÜ' },
            { id: 'dish9', name: 'ËÑÜËÑÜÁÇ∏ÈõûÂ°ä', price: 22, category: 'ÊñôÁêÜ' },
            { id: 'dish10', name: 'ËÖêÁöÆÁÉèÂÜ¨', price: 27, category: 'ÊñôÁêÜ' },
            { id: 'dish11', name: 'ÈáúÁéâÁÉèÂÜ¨', price: 28, category: 'ÊñôÁêÜ' },
            { id: 'dish12', name: 'ÁÇ∏Ëù¶Â§©Â©¶ÁæÖÁÉèÂÜ¨', price: 28, category: 'ÊñôÁêÜ' },
            { id: 'dish13', name: 'ÁÇ∏Ëù¶Â§©Â©¶ÁæÖÊãºÁõ§', price: 28, category: 'ÊñôÁêÜ' },
            { id: 'dish14', name: 'Ë±öÈ™®ÊãâÈ∫µ', price: 32, category: 'ÊñôÁêÜ' },
            { id: 'dish15', name: 'ÈØõÈ≠öÊπØËúÜËÇâÊãâÈ∫µ', price: 33, category: 'ÊñôÁêÜ' },
            { id: 'dish16', name: 'ÁâõËÇâÁÉèÂÜ¨', price: 33, category: 'ÊñôÁêÜ' },
            { id: 'dish17', name: '‰∏âÊñáÈ≠öÂà∫Ë∫´Áõõ', price: 39, category: 'ÊñôÁêÜ' },
            { id: 'dish18', name: 'ÂÖ≠ÈÅ∏Âà∫Ë∫´Áõõ', price: 39, category: 'ÊñôÁêÜ' },
            { id: 'dish19', name: 'Ëµ§Ëù¶Âà∫Ë∫´', price: 39, category: 'ÊñôÁêÜ' },

            // ÁîúÂìÅ
            { id: 'dish20', name: 'ËúúÁìúÂë≥Èõ™Ëë©', price: 13, category: 'ÁîúÂìÅ' },
            { id: 'dish21', name: 'ÂÜ∑ÂáçËäíÊûú', price: 13, category: 'ÁîúÂìÅ' },
            { id: 'dish22', name: 'ÁâõÂ•∂Âë≥ËªüÈõ™Á≥ï(ÊúâÊõ≤Â•á)', price: 18, category: 'ÁîúÂìÅ' },
            { id: 'dish23', name: 'ÁâõÂ•∂Âë≥ËªüÈõ™Á≥ï', price: 18, category: 'ÁîúÂìÅ' },
            { id: 'dish24', name: 'Â£ΩÂè∏ÈÉéÁ∂ìÂÖ∏Â∏ÉÁî∏', price: 22, category: 'ÁîúÂìÅ' },
            { id: 'dish25', name: 'Âç°ÈÅîÊãâÂ®ú', price: 22, category: 'ÁîúÂìÅ' },
            { id: 'dish26', name: 'ÂçÉÂ±§ËõãÁ≥ï', price: 22, category: 'ÁîúÂìÅ' },
            { id: 'dish27', name: 'ÊäπËå∂Ëï®È§ÖËä≠Ëè≤', price: 27, category: 'ÁîúÂìÅ' },
            { id: 'dish28', name: 'Êú±Âè§ÂäõÈ¶ôËéìËä≠Ëè≤', price: 27, category: 'ÁîúÂìÅ' },

            // È£≤ÂìÅ
            { id: 'dish29', name: 'Áôæ‰∫ãÂèØÊ®Ç(ÁÑ°Á≥ñ)', price: 8, category: 'È£≤ÂìÅ' },
            { id: 'dish30', name: 'Áôæ‰∫ãÂèØÊ®Ç', price: 8, category: 'È£≤ÂìÅ' },
            { id: 'dish31', name: 'ÁæéÂπ¥ÈÅîÊ©ôÊ±Å', price: 8, category: 'È£≤ÂìÅ' },
            { id: 'dish32', name: '‰∏ÉÂñú', price: 8, category: 'È£≤ÂìÅ' },
            { id: 'dish33', name: 'Á∂≠‰ªñÊ∞£Ê≥°Ê™∏Ê™¨Ëå∂', price: 8, category: 'È£≤ÂìÅ' },
            { id: 'dish34', name: '100ÔºÖËòãÊûúÊ±Å', price: 8, category: 'È£≤ÂìÅ' },
            { id: 'dish35', name: 'Á∫ñËß£Ëå∂', price: 9, category: 'È£≤ÂìÅ' },

            // ÈÖíÈ°û
            { id: 'dish36', name: 'ËèäÊ≠£ÂÆó', price: 17, category: 'ÈÖíÈ°û' },
            { id: 'dish37', name: 'Horoyoi(Ëë°ËêÑÂë≥)', price: 19, category: 'ÈÖíÈ°û' },
            { id: 'dish38', name: 'Horoyoi(ÊüöÂ≠êÈπΩÂë≥)', price: 19, category: 'ÈÖíÈ°û' },
            { id: 'dish39', name: '‰∏âÂæóÂà©È†ÇÁ¥öÂï§ÈÖí', price: 24, category: 'ÈÖíÈ°û' },
            { id: 'dish40', name: 'Ê¢ÖÈÖí(Âê´Ê¢ÖÂ≠ê)', price: 27, category: 'ÈÖíÈ°û' },
            { id: 'dish41', name: 'Â®ÅÂ£´ÂøåÊ¢≥Êâì', price: 27, category: 'ÈÖíÈ°û' },
            { id: 'dish42', name: 'ËèäÊ≠£ÂÆó(Â§ßÂêüÈáÄ)', price: 59, category: 'ÈÖíÈ°û' }
        ];

        let counts = { red: 0, silver: 0, gold: 0, black: 0 };
        const prices = { red: 12, silver: 17, gold: 22, black: 27 };
        let specialCounts = {};
        let customItems = [];
        let customItemId = 0;

        // ÂàùÂßãÂåñÁâπÂà•ÊñôÁêÜË®àÊï∏
        specialDishes.forEach(dish => {
            specialCounts[dish.id] = 0;
        });

        function updateCount(type, change) {
            if (counts[type] + change < 0) return;
            counts[type] += change;
            document.getElementById(type + '-count').innerText = counts[type];
            calculateTotal();
            if (navigator.vibrate) navigator.vibrate(30);
        }

        function openCountInputModal(type) {
            const modal = document.createElement('div');
            modal.className = 'count-input-modal';
            modal.id = 'tempCountModal';
            
            const dialog = document.createElement('div');
            dialog.className = 'count-input-dialog';
            
            const title = document.createElement('h3');
            title.textContent = 'Ëº∏ÂÖ•Êï∏ÁõÆ';
            
            const input = document.createElement('input');
            input.type = 'number';
            input.min = '0';
            input.value = counts[type];
            input.placeholder = 'Ëº∏ÂÖ•Êï∏ÁõÆ';
            
            const buttonsDiv = document.createElement('div');
            buttonsDiv.className = 'count-input-buttons';
            
            const cancelBtn = document.createElement('button');
            cancelBtn.className = 'btn-cancel';
            cancelBtn.textContent = 'ÂèñÊ∂à';
            cancelBtn.onclick = () => modal.remove();
            
            const confirmBtn = document.createElement('button');
            confirmBtn.className = 'btn-confirm';
            confirmBtn.textContent = 'Á¢∫Ë™ç';
            confirmBtn.onclick = () => {
                const newCount = parseInt(input.value) || 0;
                if (newCount < 0) return;
                counts[type] = newCount;
                document.getElementById(type + '-count').innerText = counts[type];
                calculateTotal();
                modal.remove();
                if (navigator.vibrate) navigator.vibrate(30);
            };
            
            buttonsDiv.appendChild(cancelBtn);
            buttonsDiv.appendChild(confirmBtn);
            
            dialog.appendChild(title);
            dialog.appendChild(input);
            dialog.appendChild(buttonsDiv);
            modal.appendChild(dialog);
            
            document.body.appendChild(modal);
            input.focus();
            input.select();
        }

        function openCustomItemModal() {
            const modal = document.createElement('div');
            modal.className = 'count-input-modal';
            
            const dialog = document.createElement('div');
            dialog.className = 'count-input-dialog';
            
            const title = document.createElement('h3');
            title.textContent = 'Ëº∏ÂÖ•È†ÖÁõÆÈáëÈ°ç';
            
            const input = document.createElement('input');
            input.type = 'number';
            input.min = '0';
            input.placeholder = 'Ëº∏ÂÖ•ÈáëÈ°ç (‰æãÂ¶Ç: 30)';
            
            const buttonsDiv = document.createElement('div');
            buttonsDiv.className = 'count-input-buttons';
            
            const cancelBtn = document.createElement('button');
            cancelBtn.className = 'btn-cancel';
            cancelBtn.textContent = 'ÂèñÊ∂à';
            cancelBtn.onclick = () => modal.remove();
            
            const confirmBtn = document.createElement('button');
            confirmBtn.className = 'btn-confirm';
            confirmBtn.textContent = 'Á¢∫Ë™ç';
            confirmBtn.onclick = () => {
                const amount = parseFloat(input.value);
                if (isNaN(amount) || amount < 0) {
                    alert('Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÈáëÈ°ç');
                    return;
                }
                customItems.push({
                    id: customItemId++,
                    amount: amount
                });
                renderCustomItems();
                calculateTotal();
                modal.remove();
                if (navigator.vibrate) navigator.vibrate(30);
            };
            
            buttonsDiv.appendChild(cancelBtn);
            buttonsDiv.appendChild(confirmBtn);
            
            dialog.appendChild(title);
            dialog.appendChild(input);
            dialog.appendChild(buttonsDiv);
            modal.appendChild(dialog);
            
            document.body.appendChild(modal);
            input.focus();
        }

        function deleteCustomItem(id) {
            customItems = customItems.filter(item => item.id !== id);
            renderCustomItems();
            calculateTotal();
        }

        function renderCustomItems() {
            const listDiv = document.getElementById('custom-items-list');
            listDiv.innerHTML = '';
            
            customItems.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'custom-item';
                
                const infoDiv = document.createElement('div');
                infoDiv.className = 'custom-item-info';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'custom-item-name';
                nameDiv.textContent = 'È†ÖÁõÆ ' + (customItems.indexOf(item) + 1);
                
                const amountDiv = document.createElement('div');
                amountDiv.className = 'custom-item-amount';
                amountDiv.textContent = '$' + item.amount.toFixed(0);
                
                infoDiv.appendChild(nameDiv);
                infoDiv.appendChild(amountDiv);
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'custom-item-delete';
                deleteBtn.textContent = '√ó';
                deleteBtn.onclick = () => deleteCustomItem(item.id);
                
                itemDiv.appendChild(infoDiv);
                itemDiv.appendChild(deleteBtn);
                
                listDiv.appendChild(itemDiv);
            });
        }

        function updateSpecialDishCount(dishId, change) {
            if (specialCounts[dishId] + change < 0) return;
            specialCounts[dishId] += change;
            
            // Êõ¥Êñ∞ modal ‰∏≠ÁöÑÈ°ØÁ§∫
            const countDisplay = document.getElementById(dishId + '-count');
            if (countDisplay) countDisplay.innerText = specialCounts[dishId];
            
            calculateTotal();
            if (navigator.vibrate) navigator.vibrate(30);
        }

        function openSpecialDishesModal() {
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = '';

            const categories = ['ÊñôÁêÜ', 'ÁîúÂìÅ', 'È£≤ÂìÅ', 'ÈÖíÈ°û'];
            
            categories.forEach(category => {
                const categoryDishes = specialDishes.filter(d => d.category === category);
                if (categoryDishes.length === 0) return;

                // ÂàÜÈ°ûÊ®ôÈ°å
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'modal-category';
                categoryDiv.textContent = category;
                modalBody.appendChild(categoryDiv);

                // Ë©≤ÂàÜÈ°û‰∏ãÁöÑËèúÈ†Ö
                categoryDishes.forEach(dish => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'modal-item';
                    itemDiv.innerHTML = `
                        <div class="modal-item-info">
                            <div class="modal-item-name">${dish.name}</div>
                            <div class="modal-item-price">$${dish.price}</div>
                        </div>
                        <div class="modal-item-controls">
                            <button class="small-btn small-btn-minus" onclick="updateSpecialDishCount('${dish.id}', -1)">‚àí</button>
                            <div class="modal-item-count" id="${dish.id}-count">${specialCounts[dish.id]}</div>
                            <button class="small-btn small-btn-plus" onclick="updateSpecialDishCount('${dish.id}', 1)">+</button>
                        </div>
                    `;
                    modalBody.appendChild(itemDiv);
                });
            });

            document.getElementById('specialDishesModal').showModal();
        }

        function calculateTotal() {
            // Ë®àÁÆóÁ¢üÂ≠êÁ∏ΩÈ°ç
            let foodTotal = (counts.red * prices.red) + 
                            (counts.silver * prices.silver) + 
                            (counts.gold * prices.gold) + 
                            (counts.black * prices.black);
            
            // Ë®àÁÆóÁ¢üÂ≠êÁ∏ΩÊï∏
            let totalPlates = counts.red + counts.silver + counts.gold + counts.black;

            // Ë®àÁÆóÁâπÂà•ÊñôÁêÜÁ∏ΩÈ°çÂíåË®àÊï∏
            let specialTotal = 0;
            let specialCount = 0;
            specialDishes.forEach(dish => {
                specialTotal += specialCounts[dish.id] * dish.price;
                specialCount += specialCounts[dish.id];
            });

            foodTotal += specialTotal;

            // Âä†‰∏äËá™Ë®ÇÈ†ÖÁõÆÁöÑÈáëÈ°ç
            let customTotal = 0;
            customItems.forEach(item => {
                customTotal += item.amount;
            });
            foodTotal += customTotal;

            // Ë®àÁÆóÂä†ÊúçÂãôË≤ª
            let grandTotal = Math.round(foodTotal * 1.1);

            // Êõ¥Êñ∞Áï´Èù¢
            document.getElementById('total-plates').innerText = totalPlates;
            document.getElementById('special-count').innerText = specialCount;
            document.getElementById('special-total').innerText = specialTotal;
            document.getElementById('subtotal').innerText = foodTotal;
            document.getElementById('grand-total').innerText = grandTotal;
        }

        function resetAll() {
            if (!confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÁ¥ÄÈåÑÈáçÊñ∞Ë®àÁÆóÂóéÔºü')) return;
            
            counts = { red: 0, silver: 0, gold: 0, black: 0 };
            document.getElementById('red-count').innerText = 0;
            document.getElementById('silver-count').innerText = 0;
            document.getElementById('gold-count').innerText = 0;
            document.getElementById('black-count').innerText = 0;
            
            specialDishes.forEach(dish => {
                specialCounts[dish.id] = 0;
            });
            
            customItems = [];
            customItemId = 0;
            renderCustomItems();
            calculateTotal();
        }

        // ÈóúÈñâ modal ÊôÇËá™ÂãïË®àÁÆó
        document.getElementById('specialDishesModal').addEventListener('close', calculateTotal);

        // È†ÅÈù¢Âä†ËºâÊôÇÂàùÂßãÂåñ
        calculateTotal();
    </script>
</body>
</html>
